var app=angular.module("gaDatePickerRange",[]);app.directive("focusOn",[function(){return function(t,e,a){return t.$on("focusOn",function(t,n){return n===a.focusOn?e[0].focus():void 0})}}]),app.factory("focus",["$rootScope","$timeout",function(t,e){return function(a){return e(function(){return t.$broadcast("focusOn",a)})}}]),app.directive("gaDateRangePicker",[function(){return{restrict:"A",transclude:!0,scope:{range1:"=",nMonth:"@"},template:'<button type="button" class="btn btn-default" ng-click="switchDisplay( true )">{{range1.startLabel}} - {{range1.endLabel}}</button><div class="gadpBox" ng-show="display"><div style="float:left"><button class="btn btn-default btn-xs" ng-click="move( -1 )"><span style="font-size: 12px;">&Lt;</span></button></div><div style="float:left;"><table class="gadpTable" cellpadding="0" cellspacing="0"><thead><tr><td class="gadpHeadTd" colspan="7" ng-repeat="month in calend.months track by $index">{{month.name}} {{month.year}}</td></tr></thead><tbody><tr><td class="gadpWeekDay" ng-repeat="weekDay in calend.weekDays track by $index">{{weekDay.substr(0,1).toUpperCase()}}</td></tr><tr ng-repeat="week in calend.weekGroups track by $index"><td class="gadpCell" ng-class="\'gadpCell\' + day.type" ng-click="setDate( day.date )" ng-repeat="day in week track by $index">{{day.numDay}}</td></tr></tbody></table></div><div style="float:left"><button class="btn btn-default btn-xs" ng-click="move( 1 )"><span style="font-size: 12px;">&Gt;</span></button></div><div style="float:left;margin-left: 10px"><div class="gadpText">Période : <select ng-model="currentPeriod" ng-change="changePeriod()"><option ng-repeat="(key,period) in spePeriods" value="{{key}}" ng-selected="key==currentPeriod">{{period.label}}</option></select></div><div class="gadpDatesInputs"><form role="form" class="form-inline"><input type="text" class="form-control input-sm" focus-on="dateStart" ng-focus="focusDate(\'start\' , $event )" ng-model="dates.startLabel" ng-blur="dateBlur( \'start\' , dates.startLabel )">-<input type="text" class="form-control input-sm" focus-on="dateEnd" ng-focus="focusDate(\'end\' , $event )" ng-model="dates.endLabel" ng-blur="dateBlur( \'end\' , dates.endLabel )"></form></div><button class="btn btn-primary btn-xs" ng-click="valid()">Appliquer</button>&nbsp;<button class="btn btn-default btn-xs"ng-click="switchDisplay( false )">Annuler</button></div><div style="clear: both"></div></div>',controller:["$scope","focus","$element","$attrs","$transclude",function(t,e){var a=moment().startOf("day");t.spePeriods={1:{label:"Personnalisée"},2:{label:"Aujourd'hui",calculate:function(){n(a.format("YYYY-MM-DD"),a.format("YYYY-MM-DD"))}},3:{label:"Hier",calculate:function(){var t=angular.copy(a).subtract(1,"day");n(t.format("YYYY-MM-DD"),t.format("YYYY-MM-DD"))}},4:{label:"Semaine courante",calculate:function(){var t=angular.copy(a).startOf("week");n(t.format("YYYY-MM-DD"),a.format("YYYY-MM-DD"))}},5:{label:"Semaine dernière",calculate:function(){var t=angular.copy(a).subtract(1,"week").startOf("week"),e=angular.copy(t).endOf("week");n(t.format("YYYY-MM-DD"),e.format("YYYY-MM-DD"))}},6:{label:"Mois courant",calculate:function(){var t=angular.copy(a).startOf("month");n(t.format("YYYY-MM-DD"),a.format("YYYY-MM-DD"))}},7:{label:"Mois dernier",calculate:function(){var t=angular.copy(a).subtract(1,"month").startOf("month"),e=angular.copy(t).endOf("month");n(t.format("YYYY-MM-DD"),e.format("YYYY-MM-DD"))}},8:{label:"Les 7 derniers jours",calculate:function(){var t=angular.copy(a).subtract(6,"day");n(t.format("YYYY-MM-DD"),a.format("YYYY-MM-DD"))}},9:{label:"Les 30 derniers jours",calculate:function(){var t=angular.copy(a).subtract(29,"day");n(t.format("YYYY-MM-DD"),a.format("YYYY-MM-DD"))}}},t.currentPeriod=1,t.changePeriod=function(){t.spePeriods[t.currentPeriod].calculate&&t.spePeriods[t.currentPeriod].calculate()};var n=function(e,a){t.dates={start:e,startLabel:moment(e).format("ll"),end:a,endLabel:moment(a).format("ll"),select:t.dates.select},t.calend=r(s.month(),s.year(),{dateStart:t.dates.start,dateEnd:t.dates.end})};t.range1.start||(t.range1.start=a.format("YYYY-MM-DD")),t.range1.end||(t.range1.end=a.format("YYYY-MM-DD")),t.range1.startLabel=moment(t.range1.start).format("ll"),t.range1.endLabel=moment(t.range1.end).format("ll"),t.display=!0,t.nMonth||(t.nMonth=3);var r=function(e,a,n){n||(n={});var r=moment().startOf("day"),s=angular.copy(r),o=angular.copy(r).endOf("day");n.dateStart&&n.dateEnd&&(s=moment(n.dateStart).startOf("day"),o=moment(n.dateEnd).endOf("day"));for(var d=t.nMonth,l={weekDays:[],months:[]},c=[],m=0;7>m;m++)c.push(moment().weekday(m).format("ddd"));for(var u=moment({y:a,M:e,d:1}),i=0,m=0;d>m;m++){var f=angular.copy(u).subtract(m,"month"),Y={name:f.format("MMMM"),year:f.format("YYYY"),minWeekNum:60,maxWeekNum:0,numWeeks:0,weeks:[]},p=angular.copy(f),y=0,g=0,b=0;do{g!=p.week()&&(b++,g=p.week()),Y.weeks[b-1]||(Y.weeks[b-1]=[],y++);var D={numDay:p.get("date"),date:p.format("YYYY-MM-DD"),type:"nds"};p.isAfter(r)||(D.type="select"),(p.isSame(s)||p.isAfter(s)&&p.isBefore(o))&&(D.type="inRange"),Y.weeks[b-1].push(D),p.add(1,"day")}while(1!=p.get("date"));var M=Y.weeks[0].length;if(7>M)for(;Y.weeks[0].unshift({numDay:"",type:"nds"})<7;);if(Y.weeks[Y.weeks.length-1].length<7)for(;Y.weeks[Y.weeks.length-1].push({numDay:"",type:"nds"})<7;);l.weekDays=l.weekDays.concat(c),l.months.unshift(angular.copy(Y)),i=Math.max(i,y)}for(var v=[],m=0;i>m;m++){v[m]||(v[m]=[]);for(var k=0;d>k;k++){var Y=l.months[k];if(Y.weeks[m])v[m]=v[m].concat(Y.weeks[m]);else{var h={numDay:"",type:"nds"};v[m]=v[m].concat([h,h,h,h,h,h,h])}}}return l.weekGroups=v,l};t.switchDisplay=function(e){t.display=e},t.move=function(e){1==e&&s.add(1,"month"),-1==e&&s.subtract(1,"month"),t.calend=r(s.month(),s.year(),{dateStart:t.dates.start,dateEnd:t.dates.end})},t.focusDate=function(e){t.dates[e+"Label"]=moment(t.dates[e]).format("DD/MM/YYYY"),t.dates.select=e,t.currentPeriod=1},t.setDate=function(a){var n=moment(a);n.isBefore(t.dates.start)&&"end"==t.dates.select?(t.dates.start=a,t.dates.startLabel=moment(t.dates.start).format("ll"),t.dates.select="start"):(t.dates[t.dates.select]=a,t.dates[t.dates.select+"Label"]=moment(a).format("ll"),"start"==t.dates.select?(t.dates.select="end",e("dateEnd")):(t.dates.select="start",e("dateStart"))),moment(t.dates.start).isAfter(t.dates.end)&&(t.dates.end=angular.copy(t.dates.start),t.dates.endLabel=moment(t.dates.end).format("ll")),t.calend=r(s.month(),s.year(),{dateStart:t.dates.start,dateEnd:t.dates.end})},t.dateBlur=function(e,a){moment(a,["DD-MM-YYYY","DD/MM/YYYY"],moment.locale(),!0).isValid()?(t.dates[e]=moment(a,["DD-MM-YYYY","DD/MM/YYYY"],moment.locale(),!0).format("YYYY-MM-DD"),t.dates[e+"Label"]=moment(t.dates[e]).format("ll")):t.dates[e+"Label"]=moment(t.dates[e]).format("ll"),t.calend=r(s.month(),s.year(),{dateStart:t.dates.start,dateEnd:t.dates.end})},t.dates={start:angular.copy(t.range1.start),startLabel:moment(t.range1.start).format("ll"),end:angular.copy(t.range1.end),endLabel:moment(t.range1.end).format("ll"),select:"start"},t.valid=function(){t.range1={start:t.dates.start,startLabel:moment(t.dates.start).format("ll"),end:t.dates.end,endLabel:moment(t.dates.end).format("ll")},t.display=!1},e("dateStart");var s=moment(t.dates.end);t.calend=r(a.month(),a.year(),{dateStart:t.dates.start,dateEnd:t.dates.end})}]}}]);
//# sourceMappingURL=gaDatePickerRange.min.js.map